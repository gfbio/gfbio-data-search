<div class="date-picker-container">
  <mat-accordion>
    <mat-expansion-panel class="mt-3" [expanded]="openChart">
      <mat-expansion-panel-header class="card-header align-items-center" style="height: 40px">
        <div class="d-flex align-items-center w-100">
          <mat-icon class="filterIcon me-2">{{ datePicker.icon }}</mat-icon>
          <span>{{ datePicker.title }}</span>
        </div>
      </mat-expansion-panel-header>

      <div class="pt-4">
        <div class="date-picker-inputs">
          <ng-container *ngIf="datePicker.type === 'collection'; else yearPicker">
            <mat-form-field class="w-100 mb-2">
              <input matInput [matDatepicker]="startPicker" placeholder="Start date" 
                     (dateChange)="setDate($event, 'start')" [value]="start" [max]="maxDate" [matDatepickerFilter]="dateFilter">
              <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
              <mat-datepicker #startPicker></mat-datepicker>
            </mat-form-field>
            <mat-form-field class="w-100 mb-2">
              <input matInput [matDatepicker]="endPicker" placeholder="End date" 
                     (dateChange)="setDate($event, 'end')" [value]="end" [max]="maxDate" [matDatepickerFilter]="dateFilter">
              <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
              <mat-datepicker #endPicker></mat-datepicker>
            </mat-form-field>
          </ng-container>
          <ng-template #yearPicker>
            <mat-form-field class="w-100 mb-2">
              <input matInput [matDatepicker]="startYearPicker" placeholder="Start year" 
                     readonly [value]="startFormat" [max]="maxDate" [matDatepickerFilter]="dateFilter">
              <mat-datepicker-toggle matSuffix [for]="startYearPicker"></mat-datepicker-toggle>
              <mat-datepicker #startYearPicker startView="multi-year"
                (yearSelected)="chooseYear($event, 'start'); startYearPicker.close()">
              </mat-datepicker>
            </mat-form-field>
            <mat-form-field class="w-100 mb-2">
              <input matInput [matDatepicker]="endYearPicker" placeholder="End year" 
                     readonly [value]="endFormat" [max]="maxDate" [matDatepickerFilter]="dateFilter">
              <mat-datepicker-toggle matSuffix [for]="endYearPicker"></mat-datepicker-toggle>
              <mat-datepicker #endYearPicker startView="multi-year"
                (yearSelected)="chooseYear($event, 'end'); endYearPicker.close()">
              </mat-datepicker>
            </mat-form-field>
          </ng-template>
        </div>
        <div class="apply-button-container">
          <button mat-raised-button color="secondary" (click)="applyDate()">Apply</button>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>
